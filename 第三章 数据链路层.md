### 本章要点：
- 数据链路层基本问题
- PPP
- CSMA/CD
- 以太网的概述
- 星型局域网
- 交换机（不使用CSMA/CD协议）
- 以太网的拓展
### 1. 数据链路层的几个基本问题


 #####  1. 数据链路层的一些概念：
 
>>>1. 链路：从一个节点到相邻节点的一段物理线路
>>>2. 数据链路：除了物理线路以外，必须有一些协议来控制数据的传输。即，物理链路+必要的协议
>>>3. 帧：数据链路层的协议数据单元
>>>![[Pasted image 20240619214719.png]]
##### 2. 封装成帧：
![[Pasted image 20240619214821.png]]
> 1. 在一段数据的前后加上首部和尾部构成了一个帧。
> 2. 帧界定符：用于界定一个帧的首部和尾部。
> 3. MTU ：最大传输单元

##### 3. 透明传输：
>
主要是为了解决帧界定符与数据文本的一些重复问题。（为了防止错误的找到边界）

>其中，透明的意思是某些事物看起来不存在一样。

>解决方法：
>1. 在发送端：数据中如果出现界定符的话，加一个填充字节
>2. 在接受端：在数据中过滤掉填充内容
>
>eg：![[Pasted image 20240619215606.png]]
>
##### 4. 差错检验：
>>> 比特差错

为了解决传输数据的误码问题


> 解决方法：CRC
原理： 发送数据时多加一个冗余序列用于差错检验。两方事先规定一个除数P(n+1位)，在M后面加n个0，然后M1%P=FCS(n位)，最后发送的数据就是M+FCS

P(X)也可以用多项式表示
![[Pasted image 20240620151210.png]]

>>> 其他差错：
>帧丢失、帧重复、帧失序

### 2. 点对单协议PPP
 用户计算机接入ISP进行通信时使用的
 ![[Pasted image 20240620151533.png]]



 ##### 1.PPP协议的特点：


> 满足的需求：
> 1. 简单
> 2. 封装成帧
> 3. 透明性
> 4. 多种网络协议
> 5. 多种链路类型
> 6. 差错检验
> 7. 监测连接状态
> 8. 最大传输单元
> 9. 网络层地址协商
> 10. 数据压缩协商


> 协议的组成：
> 1. IP数据报封装方法
> 2. LCP
> 3. NCP

##### 2.PPP协议的帧格式
![[Pasted image 20240620152211.png]]

各字段的意义：
> 1. 两个F 都是标志字段界定符
> 2. AC现在还未使用
> 3. 协议指明了信息部分的协议
> 4. FCS为循环冗余校验码

字节填充：
![[Pasted image 20240620152715.png]]


零比特填充：
每五个连续的1出现就添加一个0
![[Pasted image 20240620152844.png]]

##### 3. PPP协议的工作状态
![[Pasted image 20240620153026.png]]

### 3. 使用广播信道的数据链路层

##### 1. 局域网的数据链路层

> 局域网的一些类别：
![[Pasted image 20240620153526.png]]

>如何共享信道？
> 1. 静态划分：  时分复用、频分复用、波分复用.....
> 2.动态媒体接入（更适合局域网）：随机接入和受控接入


> 以太网(Ethernet)：是一种应用最广泛的局域网

> 适配器：网卡。实现计算机与外界局域网的连接的媒介。每个网卡都有一个自己的MAC物理地址。
> ![[Pasted image 20240620154311.png]]

##### 2. CSMA/CD协议

>引入：
- 1. 在最早的以太网中，使用的是总线型连接
- 2. 采用的是无连接交付方式，最大可能交付
- 3. 以太网发送的数据都是曼彻斯特编码
- ![[Pasted image 20240620154732.png]]

>CSMA/CD:
特点介绍:
- 载波监听多点接入/碰撞检测
- 总线型网络、一直在进行检测信道、碰撞检测
- 一个站不可能同时发送和接受（半双工通信）
- 每一个站在发送后，的2t（碰撞窗口）内存在着遭到碰撞的可能。


如果发生了碰撞的话，要使用退避算法来进行重传。
> 二进制指数退避算法：
![[Pasted image 20240622135816.png]]

当重传次数大于16时，向上报告，并进行丢弃。
另外，当长度小于64的帧统统丢掉。

如果发生了碰撞，除了立刻停止发送数据以外，来要发送一些认为干扰数据，来进行强化碰撞。

> 归纳：![[Pasted image 20240622140236.png]]

##### 3. 一些以太网的相关概念：
> 使用集线器的星型拓扑：

传统以太网使用的是粗同轴电缆，后来是细同轴电缆，最后是双绞线。这种以太网使用的是星型拓扑，增加了一个集线器(hub)。

![[Pasted image 20240622140553.png]]
>>集线器： 
1. 使用集线器在逻辑上仍然是总线网，仍使用CSMA/CD协议。
2. 一个集线器有许多的接口。
3. 集线器工作在物理层，每个端口只进行简单的转发比特，不进行碰撞检测。

###### 以太网的信道利用率：
![[Pasted image 20240622141115.png]]
信道极限利用率：![[Pasted image 20240622141209.png]]

###### 以太网的MAC层：
> 硬件地址：mac地址，是标识一个计算机网卡的地址，保留在ROM中
> 一个MAC地址有48位。

> 硬件地址的申请：
> 1. 本地管理：不向IEEE购买OUI，把地址的第一字节的第二位G/L位=1
> 2. 全球地址:G/L位=0

MAC帧的格式：
![[Pasted image 20240622141729.png]]
>> 前同步码：使接收端的适配器在接受MAC帧时能够迅速调整期时钟频率，使它和发送端的时钟同步。

>> 帧开始定界符：表明mac帧的到来

另外，一般mac帧的长度是大于64字节的，如果小于64字节的话就进行字节填充。

### 4. 以太网的拓展：
把以太网的范围进行扩展。
##### 1. 在物理层进行扩展：

方法一：使用光纤进行扩展![[Pasted image 20240622142326.png]]

方法二：使用集线器进行扩展![[Pasted image 20240622142359.png]]
##### 2. 在数据链路层进行扩展：

一些概念：
- 1.在一个总线型局域网中，一个主机向所有的主机发送数据，然后每一个主机根据自己的目的帧MAC地址和自己的对比然后进行接受或者拒接接受。 
- 2. 网桥：进行MAC帧的过滤和转发
- 3. 交换机:实质上是一个多端口的网桥，其内部的交换表是通过自学习算法自动的建立起来的。


> 交换机的自学习能力：
> 一个交换表中的每一列都是一个MAC地址和一个端口，以及一个写入时间。

另外我们采用STP协议来解决无线兜圈子的问题，其要点是不改变网络的实际拓扑结构，在逻辑上切断某些链路。
![[Pasted image 20240622143549.png]]

以太网的交换机不适用CSMA/CD协议，但是他的帧结构仍未改变。
###### 虚拟局域网(VLAN)：
虚拟局域网实际上是一种服务额，而不是一种实际上的局域网。

>具体实现：
>在以太网的mac帧中加一个VLAN 标签。
>![[Pasted image 20240622144119.png]]
>VID：标识了这个mac帧数据哪一个VLAN
>不过要是要实现跨交换机的VLAN设计，要在交换机之间的增加一个汇聚链路（trunk link）
>![[Pasted image 20240622144353.png]]
要是想要实现VLAN 10和VLAN 20之间的通信的话，就要使用三层交换机进行实现。

### 5. 个人总结：
本章主要是讲述了以下几个方面：
- 数据链路层的三个基本问题
- 数据链路层的两种信道
- 介绍了PPP协议和CSMA/CD协议的主要内容和适用范围
- 主要介绍了星型局域网的原理和一些基本器件

一般来说，我们可以首先构建一个我们自己的局域网：
1. 我们可以采用CSMA/CD协议和总线型局域网进行建立。
2. 我们也可以采用交换机来进行建立星型局域网。这种情况下，我们一般传输的是MAC地址然后在交换机上进行数据传输。这是在数据链路层的上面进行工作的。
3. 我们如果想要对我们的局域网进行一个拓展的话，一般也有两种选择。我们可以选择子啊物理层上进行拓展，使用光纤或者集线器。另外我们可以在数据链路层上进行拓展。我们可以搭建虚拟局域网，在逻辑上扩大了局域网的范围。
