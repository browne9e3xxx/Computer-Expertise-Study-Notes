### 本章要点：
- 网络层的一些概念
- IPv4、 MAC地址、数据报格式等问题
- IP层分组转发的过程
- ICMP
- ipv6
- 路由选择协议
- IP多播
- VPN和 NAT
- MPLS

### 1. 网络层的几个重要概念
##### 1.1 网络层提供的两种服务：
> 1. 面向连接型服务：  首先建立连接，然后进行数据传输
>  2. 尽量简单、只向上层提供无连接的、尽最大努力交付的数据报服务。  因为互联网的主机不同于电脑，它具有较强的自我纠错能力。

##### 1.2 网络层的两个层面：
不同网络之间的通信，需要经过不同的路由器，在路由器中查找转发表，转发给下一个路由器。

所以，可以将网络层分为数据层面和控制层面。

> 1. 数据层面：转发源主机和主机之间的数据
> 2. 控制层面：传递路由信息，根据选择协议使用的路由算法，不断地交换分组信息来建立路由表。

新型的SDN结构：
![[Pasted image 20240622152111.png]]在传统的互联网中：每一个路由器中既含有转发表又有路由选择软件。
而在SDN结构中：每个路由器中不在有路由选择软件，也不再进行路由信息的交换了。有一个远程控制器，账务各个主机的状态，算出并给每一个路由表生成最佳的转换表。
### 2.网络协议IP
##### 2.1 虚拟互联网络：

由于技术的限制，很难使用一个单一的网络来进行将所有的设备互联。但是我们可以使用IP地址来进行抽象，使这些网络看起来像是一恶搞统一的网络。
![[Pasted image 20240622155459.png]]

互联网可以由多种异构网络组成：
![[Pasted image 20240622155822.png]]
##### 2.2 IP地址：
 IP地址就是给连接到互联网上的每一个主机一个接口。

 IP地址的表示：
> 1. 一般使用点分十进制方法：  8888
>  一个IP地址在互联网上是唯一的。
> ![[Pasted image 20240622160155.png]]
> 
![[Pasted image 20240622160208.png]]
网络号： 标志此接口连接的网络 ，主机号，标志该主机

分类IP地址：
> ![[Pasted image 20240622160358.png]]
> 1. ABC类地址都是单播地址
> 2. 网络号为01111111（127）：是进行环路测试的
> 3. 全0的是标志本网络
> 4. 分类的最初目的是为了满足不同用户的需求。
> 5. 为了解决IP地址枯竭的问题，新的无分类编址（CIDR）产生了。

CIDR:
> 无分类域路由选择
> 1. 网络前缀：![[Pasted image 20240622161045.png]]
> 2. 仍然采用这个IP结构，但是使用了斜线记法的方式，即在IP地址后面加上斜线“/"，前面表示的是网络前缀，后面表示的是主机号。
> 3. 地址块：把网络前缀都相同的IP地址组成一个”CIDR地址块“
> 4. eg：![[Pasted image 20240622161403.png]]
> 5. 地址掩码（子网掩码）： 用于计算网络的前缀。   组成：有一串连续为1和连续为0的数字组成。  计算原理：我们将二进制IP地址和子网掩码按位进行AND（且运算）求和，得到的即为IP地址的地址块
> 6. CIDR中也有三个特殊的地址快：
>           1. n=32   主机路由
>           2. n=31 点对点链路
>           3. n=0  默认路由
>  7. 路由聚合：一个大的CIDR地址块通常也包含着许多小的地址块 。

ip地址的特点：
> 1. 每一个ip地址都由网络号和主机号这两部分组成。
> 2. 路由器一般是根据网络前缀来进行转发，这样的话还可以缩短转发时间。
> 3. 一个ip地址是一个主机的一个接口。
> 4. 用交换机和路由器连接起来的若干局域网的仍为一个网络。
> 5. ip地址中，分配到所有ip地址的网络都是平等的。
> 6. ![[Pasted image 20240622163936.png]]
> 7. 路由器总是有两个及以上的ip地址，每个接口的网络前缀都不同

##### 2.3 MAC地址：
ip地址与MAC地址：
>MAC地址是ip数据层使用的地址，ip地址是网络层和一回事那个各层使用的地址，路由器也具有它的MAC地址。
>![[Pasted image 20240622164339.png]]
>ps：既然已经存在了MAC地址，为什么还要使用IP地址？
>答：因为不同设备之间的MAC地址无规律性，不方便统一规划管理。而ip地址可以据网络拓扑进行分配和管理，有利于大规模网络的组织和扩展，ip地址还可以进行动态分配。


主机或路由器怎么知道应当在MAC帧的头文件填入什么样的MAC地址?
 地址解析协议ARP:
 用于一个局域网之间
> 已知一个ip地址，求出他对应的MAC地址。
> 实现方法：
>         在主机的ARP高速缓存中存储一个从IP地址到MAC地址的映射表，并经常自动进行更新。
> 工作过程：以一个局域网中的A向B发送信息为例：
> 1. 如果映射表里已经存在的话，直接按照映射表进行转发
> 2. 如果不存在的话，A会向局域网广播一条信息，如“我是MAC地址为...的主机A,我的IP地址是。。。。。，我要向IP地址为**** 的B发送消息”。然后，收到这个信息的每个主机回核对自己的IP地址并检查过滤，B收到后会给A发送自己的MAC地址的ARP响应分组，并记下A的mac地址。
> 3. 当然，这个ARP映射表里面的映射记录都有自己的生存时间。

使用ARP的经典情况：
![[Pasted image 20240622174434.png]]
由此可见：网络链路上的帧最终是靠MAC地址来找到目的主机的。

那我们为什么还要再加上一个IP地址呢？
答：不同网络使用着不同的MAC地址，MAC地址之间的转化和寻址太复杂。而通过IP寻址，并进行与MAC之间的转化就简单多了。
##### 2.4 IP数据报的格式：
![[Pasted image 20240622175622.png]]
格式解析：
>固定部分：
- 首部：占4位，标识协议IP的版本
- 首部长度：占4位，表示的最大长度为15，单位是32位字长。所以IP地址的首部长度必须为4字节的整数倍，表示的最大为60字节，因为固定长度为20字节，所以这个的最小值为5（0101）
- 区分服务：占8位，用来获得更好的服务，一般情况下不使用。
- 总长度：首部+数据部分的长度和。单位为字节。当然一般的数据帧中都有一个MTU（以太网的规定值为1500字节），如果数据超过这个长度就会分片处理。
- 标识（identification）：占16位，IP软件子啊存储器中维持一个计数器，每产生一个数据表，计数器就加一，并赋值给标识字段。当一个数据报被分片时，就把这个字段复制给所有的被分片的标识字段中。
- 标志（flag）：占3位，目前只有前两位有意义。最低位为MF:MF=1，表示后面还有分片，MF=0表示这是最后一个分片。  中间的一位是DF:DF=0时可以分片，DF=1时不能分片。
- 片偏移：占13位 ，指出了分片之后，某一片在原分片中的位置，片偏移是以8个字节为一个单位的。![[Pasted image 20240622181325.png]]
- 生存时间：TTL，跳数限制，占8位。每在路由器中转发一次就减一，等于0时变丢弃。
- 协议：指出这点数据报携带的数据使用的是什么协议![[Pasted image 20240622181630.png]]
- 首部检验和：占16位，只检验数据报的首部，但不包括数据部分。
![[Pasted image 20240622181849.png]]
- 源地址：占32位
- 目的地址：占32位
> 可变部分：
> ![[Pasted image 20240622182005.png]]

### 3. IP层转发分组的过程：
##### 3.1 基于终点转发
分组在互联网中的转发是基于分组首部的目的地址的，这种方式称为基于终点的转发。
> 1. 而在实际中，一般会在路由器的转发表中标明查找主机的目的网络，这样可以大大减少转发表大小。
> 2. 当路由器收到一个分组时，在转发表得到下一跳的IP地址后，不是把这个地址填入分组首部，而是交送给数据链路层的网络接口软件，键下一跳的IP地址转化为MAC地址，然后放入MAC帧中，利用这个MAC帧将数据传送到下一跳的链路层。

##### 3.2 最长前缀匹配：
- 如果一个分组在路由器中可以找到多个匹配的前缀，那么就应当选择前缀最长的作为匹配的前缀。

两种特殊路由：
- 主机路由：对特定目的主机IP地址专门指明的一个路由。
- 默认路由（Default route）：是对IP数据包中的目的地址找不到存在的其他路由时，路由器所选择的路由。目的地不在路由器的路由表里的所有数据包都会使用默认路由。用无类别域间路由标记表示的IPv4默认路由是0.0.0.0/0。因为子网掩码是/0，所以它是最短的可能匹配。 当查找不到匹配的路由时，自然而然就会转而使用这条路由。

分组转发算法：
![[Pasted image 20240623164107.png]]

##### 3.3 使用二叉线索查找转发表：


先找出每一个IP地址的唯一前缀，然后用这个唯一前缀来构造二叉线索，在进行查找时，只要能和唯一前缀相匹配就行了。
![[Pasted image 20240623164515.png]]显然，二叉线索只提供了一种可以快速知道啊匹配叶节点的机制，但是否和网络前缀匹配，嗨哟啊和子网掩码进行一次逻辑AND运算。

为了提高二叉线索的查找速度，广泛运用了压缩技术。
### 4. 网络控制报文协议ICMP


目的：为了更有效的炸运发IP数据报和提高交付成功的机会。  主要是用于差错情况的检车和提供有关异常的情况。

格式：
ICMP报文作为IP数据报中的数据部分。
![[Pasted image 20240623165709.png]]

##### 4.1 ICMP报文的种类

![[Pasted image 20240623165837.png]]
- 差错报告报文：
> 1. 终点不可达： 当路由器或主机不能交付数据报时，就像源点发送这个。
> 2. 时间超过：路由器收到生存时间=0的数据报时，丢弃并发送这个。
> 3. 参数问题：当路由器或目的主机收到的数据报的首部有的字段的数据不正确。
> 4. 改变路由：让主机知道下次应该吧数据报发送给另外的路由器。
> 5. 差错报告报文段的：
> ![[Pasted image 20240623170338.png]]
> 前8个字节是为了得到运输蹭的端口号和运输层报文的发送序号。


- 差错询问报文：
  1. 回送请求或会送回答：测试目的站是否可以到达以及了解有关状态。
  2. 时间戳请求或时间戳回答：计算网络的往返时延
##### 4.2 应用举例：
>1. ping 应用:它没有通过运输层的UDP和TCP
>2. traceroute：第一个TTL设置为0每经过一个路由器，TTL减一，然后向主机发送一个时间超过的差错报文。然后第二个发送的主机TTL=2,......直到传输到目的地址。

### 5.IPv6：

使用IPv6的直接原因：IPv4地址已经耗尽了。
##### 5.1 IPv6的基本首部：
![[Pasted image 20240623171417.png]]
IPv6仍然支持无连接的传输，但把协议数据单元PDU成为分组。

IPv6引进的主要变化如下：
1. 更大的地址空间：IPv6的地址为128位
2. 扩展的地址层次结构
3. 灵活的首部格式：IPv6提供了更多的扩展功能
4. 改进选项：允许数据报包含选项控制信息，首部固定
5. 允许协议继续扩展
6. 支持即插即用（自动配置）
7. 支持资源的预分配
8. 首部改为8字节对齐，首部长度必须为8字节的整数倍。

介绍基本首部中的各字段的作用：
- 版本： 占4位，指明了协议的版本
- 通信量类：8位，区分不同IPv6数据报的优先级和类别。
- 流标号：20位，IPv6的一个机制，支持资源的预分配，并允许路由器把一个数据报与一个给定的资源分配相联系， 可以提供啊通信质量。
- 有效载荷长度：16位，指明出了基本首部意外的字节数。  拓展首部+数据部分
- 下一个首部：占8位，当IPv6数据报没有拓展首部时，这个与IPv4的协议字段一样，指明了基本首部后面的数据应该交付IP层上面的安一个高层协议；如果有拓展首部，这个就标识下一个首部的类型。
- 跳数限制：占8位
- 源地址：128位
- 目的地址：128位

拓展首部，一般有以下几种类型：  逐条选择，路由选择，分片，鉴别，封装安全有效载荷，目的站选项
##### 5.2 IPv6的地址：

三种基本类型地址：
>1. 单播：传统的点到点方式
>2. 多播：一道多，一个计算机给一组计算机发送数据
>3. 任播：终点是一组计算机中的距离最近的一个。

记法：冒号十六进制记法
> 1. 每16个字用一个16进制的表示
> 2. 允许包数字前面的零省略
> 3. 还可以进行零压缩，任一地址中只能使用一次零压缩。![[Pasted image 20240624144412.png]]
> 4. CIDR记法仍可用：![[Pasted image 20240624144620.png]]
> ![[Pasted image 20240624144716.png]]
> 全球单播地址可以是上图的任意一个。

##### 5.3 IPv4向IPv6过渡：

只能采用向下兼容和逐步演进的办法。

两种过渡策略：
> 双协议栈：
> 在完全过渡成功之前，使一部分的主机和路由器同时装有IPv4和IPv6两种协议栈，使其可以能够和两种地址通信。

> 隧道技术：
> 当IPv6经过网络进入IPv4的时候，使其成为IPv4的数据部分。
![[Pasted image 20240624145347.png]]
##### 5.4 ICMPv6：
![[Pasted image 20240624145515.png]]
### 6. ==路由选择协议==

主要是讨论路由表是怎么得出的。
##### 6.1 关于路由选择协议的几个概念

理想的路由选择算法：
- 算法正确且完整
- 计算简单
- 可以适应网络通信量和拓扑变化
- 稳定性，公平性，最佳


分层次的路由选择协议：
> 1. 采用原因：保密性和难度规模性
> 2. 自治系统AS:一般指在单一技术管理下的许多网络、IP地址以及路由器
> 3. 互联网的路由选择协议分类： 
>         1.内部网关协议：IGP，一个AS内部使用的路由选择协议。域内路由选择
>         2. 外部网关协议：EGP，不同自治系统之间的 。域间路由选择
> 

##### 6.2 内部网关协议RIP
###### 1. RIP协议的工作原理：

一种分布式的基于距离向量的路由选择协议。
> 基本原理：
> 1. 从路由器到智联的网络的距离定义为1，其他的每过经过一个主机就加1.
> 2. 每个路由器仅和相邻路由器交换信息
> 3. 每次交换的信息是这个路由器的路由表
> 4. 按固定时间间隔交换信息。
>距离向量算法： 路由表更新的原则是找到到每个网络的最短距离。
###### 2. 距离向量算法：
![[Pasted image 20240624151747.png]]

###### 3.RIP协议的一些特点：
> 1. 作为运输层udp的报文传输。![[Pasted image 20240624151951.png]]
> RIP报文由首部和路由部分组成，在路由部分哟啊填入自治系统号ASN，话哟啊之后粗，目的网络地址，下一条的路由器地址，以及到此网络的距离。
> 2. RIP协议主要运用于小型的自治系统中。RIP规定一条路径最多只包含15个网络。
> 3. 好消息传播的快，坏消息传的慢：当网络出现故障时，要经过比较长的时间才能将次信息传递到已有的路由器。
> 4. 实现简单，开销较小。

##### 6.3 内部网关协议OSPF
开放最短路径优先
###### 1.OSPF 协议的基本特点：

> 1. 使用的是链路状态协议
> 2. 向本AS中的所有路由器发送信息。使用泛洪法：每个路由器向所有相邻的路由器发送信息，每一个相邻的路由器将此信息向他所相邻的路由器发送。
> 3. 发送的信息是相邻所有路由器的链路状态
> 4. 每隔一段时间就是用泛洪法更新一下路由状态
> 每一分个路由器都知道链路中的路由状态，并使用Dijkstra的最短路径算法算法路由表。
> 5. OSPF又将一个较大的AS分为若干个区域，每个区域都有32位的区域标志符。
> 6. ![[Pasted image 20240624160252.png]]
> 7. 主干路由器，区域边界路由器，自治系统边界路由器

###### 2. OSPF的五种分组类型：
- 1. 问候分组：用来发现和维持临站的可达性。
- 2. 数据库描述：向邻站给出自己的链路状态数据库中所有链路路状态项目的摘要信息。
- 3. 链路状态请求：向对方请求发送某些链路状态项目的详细信息。
- 4. 链路状态更新： 泛洪法更新全网的链路状态
- 5. 链路状态确认：对链路更新分组的确认

OSPF分组是使用IP数据报来进行传输的：
![[Pasted image 20240624160914.png]]
##### 6.4 外部网关协议BGP

特点：
BGP只能是力求选择出一条能到到达目的网络前缀且比较好的路由，而不是计算出一条最佳路由。
###### 1. BGP路由：
- 一个自治系统中要拥有边界路由器和内部路由器两种。
- 两个边界路由器进行通信时，建立eBGP连接（半永久性的TCP连接），边界路由器可以通过eBGP连接传递“X,AS,R",意思是，”从R经过AS可到达X“
- 边界路由器同时和内部路由器建立iBGP连接，也使用TCP连接传输BGP报文。规定了AS内部所有的iBGP之间是全连通的。
![[Pasted image 20240624163648.png]]
- 注意，iBGP和eBGP是用一种协议，使用同样的报文类型和属性类型。只是通知的规则不同。
> 
![[Pasted image 20240624163936.png]]前缀是：路由终点的子网前缀
自治系统路径：告知BGP路由通过的所有自治系统
下一跳：通告得到BGP路由起点

构建路由表：![[Pasted image 20240624164305.png]]

###### 2. 三种不同的自治系统
> 末梢、穿越、对等

![[Pasted image 20240624164435.png]]

- 末梢：比较小的AS，把分组发送给直接相连的AS,不会转发
- 多归属末梢：同时连接到两个或以上的AS，可以增加可靠性。
###### 3. BGP的路由选择

如果从一个AS到另一个AS之间只有一个路由的话，就不涉及到BGP路由选择问题。但要是有多条路由可以选择的时候，就要根据以下顺序，选择一条较好的。
> 1. 本地偏好值高的优先选择：
> 本地偏好值一般是由管理员来进行人工设置。

> 2. 选择AS条数最少的路由

> 3. 热土豆路由选择算法：
>    假设这两条线路的本地优先值和选择的AS条数都相同的话，则采用该算法。
>    就是要让分组尽快离开AS1，而不考虑从哪个路由器离开，让分组经过较少的转发次数离开本AS,这时就要使用内部网关协议。

![[Pasted image 20240624165941.png]]


若以上的几种方法都无法找出最好的BGP路由，那么就用BGP标识符来选择路由。
###### 4. BGP的四种报文：
- 打开报文：用来与BGP建立对等连接关系
- 更新报文：通告某一路由的信息，列出撤销的路由。一次可以撤销多条，但是只能更新一条。
- 保活报文：周期性的验证连通性，设置了一个保持时间计时器。
- 通知报文：发送检测到的差错

###### 5. BGP报文
![[Pasted image 20240624170808.png]]
使用TCP传输，四种类型的首部相同。

##### 6.5 路由器的构成：

###### 1. 路由器的结构：
路由器是一种具有多端口的专用计算机，任务是转发分组。
![[Pasted image 20240624171846.png]]

主要分为：
- 数据部分（分组转发）：交换结构、输入、输出端口
- 控制部分（路由选择）：路由处理机构造出路由表并进行更新维护。
转发表必须要包含完成转发功能的必要信息。

###### 2.交换结构：
把每一个分组转移到某个合适的输出端口。

>最早的路由器就是普通计算机：
>CPU作为路由处理器，I/O设备作为输入输出端口


三种常用的交换方法：
![[Pasted image 20240624172815.png]]

### 7.IP多播

##### 7.1 IP多播的概念：

![[Pasted image 20240624191653.png]]
>能够运行多播协议的路由器被称为多播路由器，
在互联网上进行的多播就是IP多播。

 >1.  多播地址实际上运用的是D类地址 ，前四位是1110。范围是224.0.0.0到239.255.255.255
 > 2. 多播地址只能用于目的地址，而不能用于源地址。
##### 7.2 在局域网上进行硬件多播
D类多播地址与MAC地址建立起一一映射关系：
> D类地址和物理地址建立映射关系是为了确保多播数据包能够在数据链路层被正确传输和处理。通过这种映射机制，网络设备可以有效地识别和转发多播流量，从而提高网络通信的效率和资源利用率

具体映射：
> 由于一个MAC地址有48位，但是IANA分配到的是00-00-5E的地址块，又因为第一位表示的是多播地址，所以有23位的表示大小，这与D类地址的28位中的后23位一一对应。![[Pasted image 20240624212359.png]]

##### 7.3 网际组管理协议IGMP和多播路由选择协议
> 引入：
![[Pasted image 20240624214010.png]]我们以上图为例：
>1.上图中的R1.R2.R3都参加到了一个多播组中，其地址是226.15.37.123，然而对于R1.R2.R3，怎么知道他们下面的多播组成员的信息呢？
 >2. 这就要用到了 网际组管理协议  IGMP
> 3. ICMP是让连接在本地局域网上的多播路由器==知道==本局域网上是否有主机*参与*或*退出*了某个多播组。
> 4. 而多播转发必须动态地适应成员的变化。
>5. 多播数据报可以由没有加入多播组的主机发出，也可以通过没有组成员接入的网络。


- 多播路由选择协议侧重于在整个网络中建立和维护多播数据的传输路径。
- IGMP协议侧重于管理单个网络段中主机的多播组成员关系

###### 1. IGMP:
与ICMP类似，它也使用IP提供服务，所以IGMP其实是整个网际协议IP的一个组成部分。

> 工作阶段：
> 1. 一个主机接入新的多播组时，它向多播路由器发送一个IGMP报文，多播路由器收到之后，利用这个组关系通知给互联网上的其他多播路由器
> 2. 组成员的关系是动态的。本地多播路由器周期性的探寻摸个主机还是不是组成员。


IGMP 避免过大开销的一些方法：
![[Pasted image 20240624230550.png]]

###### 2. 多播路由选择协议：
- 多播过程中一个分组的成员是动态变化的。
- 多播路由选择实际上就是找出以源主机为跟节点的多播转发树。

除了多种实用的多播路由选择协议外，它们在转发多播数据报时采用了以下三种方法：
> 1. 洪泛与剪除：适用于较小的多播组，而所有的组成员介入的局域网也是相邻接的。使用反向路径广播RPB来避免兜圈子。每一个路由器收到一个多播数据报时，先检查是否是从源点经最短路径传过来的。若一个下游树叶没有组成员，则进行剪除。
> 2. 隧道技术:地理位置分散。比如R1和R2之间的传输网络不支持多播。R1将多播数据报进行再次封装迷失之成为单播数据报。
> 3. 基于核心的发现技术：对每一个多播组都制定一个核心路由器，给出它的单播地址。

![[Pasted image 20240624231421.png]]
### 8.虚拟专用网VPN和网络地址转化NAT
##### 8.1 虚拟局域网VPN：
![[Pasted image 20240625103242.png]]


主要讨论的是：一个局域网内部的通信，和一个局域网和另一个局域网进行通信。

>1. 由于IP地址的数量不多，所以我们允许在一个局域网内部自行分配地址，这样的地址被称为本地地址。
> 2. 在互联网中规定了一部分专用地址为本地地址。在互联网的路由器，对目的地址是专用地址的数据报一律不进行转发。![[Pasted image 20240625103528.png]]
> 3. 如果一个机构的范围太广，一般使用互联网作为本机构个专用网之间的通信载体，这样的专用网成为VPN。每个场所必须至少有一个合法的全球IP地址。
> 4. 所有通过互联网传输的数据都必须加密。

##### 8.2 网络地址转化：

主要解决的是一个专用网内部的主机与互联网上的其他主机通信的问题。

> 网络地址转化：NAT
> 1. 一个路由器上至少安装一个NAT软件，这样的路由器被称为NAT路由器。
> 2. 工作流程如下： ![[Pasted image 20240625104642.png]]
> 3. 显然，这两个之间的通信，必须由专用网内的主机发起。专用网内部的主机不能直接充当服务器。
> 4. 为了充分利用这个路由器分配的IP地址，我们使用了网络地址与端口号转换NAPT。
> 5. NAT将本地专用主机的专用地址转化之后，用一个端口号来区分它们。
> 6. 这里的端口号和应用层的端口号是一个类型但是不是同一个应用场景。


### 9. 多协议标签交换MPLS:

MPLS使用面向连接技术，使每一个分组携带一个叫标签的小证书。当分组到达交换机，交换机读取分组的标签，并用标签检索分组转发表，更快。

MPLS并未代替IP技术，而是作为：
- 支持流量工程，均衡网络负载
- 有效地支持VPN
- 支持面向连接的服务质量。
##### 9.1工作原理：
 
 
 >1. MPLS域：指该域中有趣多彼此相邻的路由器，并且所有的路由器技术都是支持 MPLS的标签交换路由器LSR，LSR同时具有标签交换和路由选择这两种功能。
 >2. 在MPLS域的入口处，对每一个IP数据报打上标签，然后对打上标签的IP数据报用硬件进行转发。这样就不用上升到第三层查找转发表，而是在第二层用硬件进行转发。
 
 ![[Pasted image 20240625111115.png]]
###### 原理解释

![[Pasted image 20240625111248.png]]

###### 几个概念：

等价转发类FEC：
路由器按照同样方式对待IP数据报的集合。
![[Pasted image 20240625111708.png]]

一旦数据包被分配到特定的FEC中，它们就会按照相同的路径（标签交换路径，LSP）通过MPLS网络进行转发。

> 可以将这种技术运用于流量工程技术，用于平衡网络负载等。

![[Pasted image 20240625112225.png]]
##### 9.2 MPLS的格式：

![[Pasted image 20240625112559.png]]

##### 9.3 新一代MPLS技术
![[Pasted image 20240625112834.png]]

### 10.软件定义网络SDN的简介：（尚待补充）


>1. 在 SDN 中数据层面的交换机是由控制层面进行控制的，这种控制是使用OpenFlow协议实现的。
>2. 这种控制在逻辑上是集中式的，是基于流的控制。

略。
